---
title: "Social Media Analytics"
author: "Group 9 - Thomas George Thomas, Yang Liu, Pratyush Pothuneedi"
date: "12/8/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#Importing the required libraries
library(tidytext)
library(tidyverse)
library(stringr)
library(lubridate)
library(ggplot2)
library(dplyr)
library(readr)
```


# 1.Introduction

## Data Acquisition


```{r}
# Social Media data from tweets. We renamed the csv file into tweets from th original file name after extraction for easier readability.
tweetsDataRaw <- read.csv('tweets.csv', header = FALSE)
```


```{r}
colnames(tweetsDataRaw) <- c("target","ids","date","flag","user","text")

```


```{r}
head(tweetsDataRaw)
```


# 1. Remove stop words and try to visualize the remaining words. (Visualize the results)

Removing stop words and username mentions from tweets and also removing Re-tweets and replies so that we have only the "original" tweets.


```{r}

remove_reg <- "&amp;|&lt;|&gt;"
tidy_tweets <- tweetsDataRaw %>% 
  filter(!str_detect(text, "^(RT|@)")) %>%
  mutate(text = str_remove_all(text, remove_reg)) %>%
  unnest_tokens(word, text, token = "tweets", strip_url = TRUE) %>%
  filter(!word %in% stop_words$word,
         !word %in% str_remove_all(stop_words$word, "'"),
         str_detect(word, "[a-z]"))
```
counting and sorting the words


```{r}
tidy_tweets %>%
count(word, sort = TRUE) %>%
  top_n(15) %>%
  mutate(word = reorder(word, n)) %>%
  ggplot(aes(x = word, y = n, fill= word)) +
  geom_col() +
  theme(legend.position="none")+
  xlab(NULL) +
  coord_flip() +
  labs(y = "Count",
       x = "Unique words",
       title = "Most frequent words found in tweets")
```

# 2. Extract different emotions from the tweets. (Visualize the results)

Adding different sentiments to each of the rows.

```{r}
# the lexicon
nrc_lexicon <- get_sentiments("nrc")

# now the job
tidy_tweets <- tidy_tweets %>%
             left_join(nrc_lexicon, by="word")

# remove NA's
tidy_tweets <- tidy_tweets %>%
  filter(sentiment!= "NA")

```


Visualizing the results

```{r}
tidy_tweets %>%
count(sentiment) %>%
  ggplot(aes(x = sentiment, y = n)) +
  geom_bar(aes(fill=sentiment),stat = "identity")+
  theme(legend.position="none")+
  xlab("Sentiments") +
  ylab("Count")+
  ggtitle("Total sentiments count")
  theme_minimal()

```

@Yang Please do this as your 2nd question
# 3. Extract different months from the date column and determine the sentiments related to the month

Adding the month column to the dataset

```{r}

tidy_tweets <- tidy_tweets %>%
  mutate(elements = str_split(date, fixed(" "), n=6)) %>% 
    mutate(Month = map_chr(elements, 2),
           Day = map_chr(elements, 1),
           Time = map_chr(elements, 4), .keep="unused")
```


```{r}
tidy_tweets %>%
  group_by(Day,sentiment) %>%
  summarize(Count=n()) %>%
  arrange(desc(Count)) %>%
  arrange(Day) %>%
  top_n(5)
```


